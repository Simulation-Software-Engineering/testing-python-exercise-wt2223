"""
Tests for functionality checks in class SolveDiffusion2D
"""

from diffusion2d import SolveDiffusion2D
import numpy as np


def test_initialize_physical_parameters():
    """
    Checks function SolveDiffusion2D.initialize_domain
    """
    solver = SolveDiffusion2D()
    
    w = 20.
    h = 5.
    dx = 0.25
    dy = 0.5
    d = 8.
    T_cold = 500.
    T_hot = 1100.
    
    solver.initialize_domain(w, h, dx, dy)
    solver.initialize_physical_parameters(d, T_cold, T_hot)

    assert solver.dt == 3.125/1000

def test_set_initial_condition():
    """
    Checks function SolveDiffusion2D.get_initial_function
    """
    solver = SolveDiffusion2D()
    
    w = 20.
    h = 5.
    dx = 0.25
    dy = 0.5
    d = 8.
    T_cold = 500.
    T_hot = 1100.
    
    solver.initialize_domain(w, h, dx, dy)
    solver.initialize_physical_parameters(d, T_cold, T_hot)
    
    assert np.all(solver.set_initial_condition() == np.array([[ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500., 1100.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
            1100.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.],
           [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
             500.]]))
    
    
