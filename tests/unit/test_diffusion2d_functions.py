"""
Tests for functions in class SolveDiffusion2D
"""

from diffusion2d import SolveDiffusion2D
import numpy as np 
import unittest


class TestDiffusion2D(unittest.TestCase):
    def setUp(self):
        self.w = 20.
        self.h = 5.
        self.dx = 0.25
        self.dy = 0.5
        self.d = 8.
        self.T_cold = 500.
        self.T_hot = 1100.
        self.nx = 80
        self.ny = 10
        
    def test_initialize_domain(self):
        """
        Check function SolveDiffusion2D.initialize_domain
        """
        solver = SolveDiffusion2D()
        
        solver.initialize_domain(self.w,self.h,self.dx,self.dy)
        self.assertEqual(solver.nx, self.nx)
        self.assertEqual(solver.ny, self.ny)
    
    def test_initialize_physical_parameters(self):
        """
        Checks function SolveDiffusion2D.initialize_domain
        """
        solver = SolveDiffusion2D()
        solver.dx = self.dx
        solver.dy = self.dy

        solver.initialize_physical_parameters(self.d, self.T_cold, self.T_hot)
        self.assertEqual(solver.dt, 3.125/1000)
    
    
    def test_set_initial_condition(self):
        """
        Checks function SolveDiffusion2D.get_initial_function
        """
        solver = SolveDiffusion2D()
        solver.T_cold = self.T_cold
        solver.T_hot = self.T_hot
        solver.nx = self.nx
        solver.ny = self.ny
        solver.dx = self.dx
        solver.dy = self.dy
        
        self.assertTrue(np.all(solver.set_initial_condition() == np.array([[ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500., 1100., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500., 1100.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                1100.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.],
               [ 500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,  500.,
                 500.]])))
        
if __name__ == '__main__':
    unittest.main()
